# Simple Reversi (C言語版)

C言語で実装したネットワーク対戦型のReversi（オセロ）ゲームです。

## 概要

TCP/IPソケットを使用して、ネットワーク経由で2人のプレイヤーがReversi（オセロ）を対戦できるCLIアプリケーションです。

## 特徴

- 8x8のボードで古典的なReversiルールを実装
- TCP/IPソケットによるネットワーク対戦
- クライアント/サーバーモードに対応
- CLIベースのシンプルなインターフェース

## ゲームルール

- 8x8のボード上でプレイ
- 黒石（B）と白石（W）の2人で対戦
- 自分の石で相手の石を挟むと、挟まれた石がひっくり返る
- 両プレイヤーが置けなくなったらゲーム終了
- 石の数が多い方が勝利

## ビルド方法

```bash
make
```

クリーンビルド：
```bash
make clean
make
```

## 使用方法

### サーバーとして起動（後手・白石）

```bash
./reversi server [ポート番号]
```

例：
```bash
./reversi server 8888
```

ポート番号を省略した場合、デフォルトで8888番ポートを使用します。

### クライアントとして起動（先手・黒石）

```bash
./reversi client <ホスト> [ポート番号]
```

例：
```bash
./reversi client 127.0.0.1 8888
```

ポート番号を省略した場合、デフォルトで8888番ポートを使用します。

## プレイ方法

1. まず、一方のマシンでサーバーを起動します：
   ```bash
   ./reversi server 8888
   ```

2. 次に、もう一方のマシンでクライアントを起動します：
   ```bash
   ./reversi client <サーバーのIP> 8888
   ```

3. 接続が確立されると、ゲームが開始します。

4. クライアント（黒石）から先手でゲームが始まります。

5. 手番が来たら、置きたい位置を `a1` から `h8` の形式で入力します：
   - 列は `a` から `h` のアルファベット
   - 行は `1` から `8` の数字
   - 例：`d3`, `e6`, `f5`

6. ゲームを途中で終了するには `quit` と入力します。

## ボード表示

```
  a b c d e f g h
1 . . . . . . . .
2 . . . . . . . .
3 . . . . . . . .
4 . . . B W . . .
5 . . . W B . . .
6 . . . . . . . .
7 . . . . . . . .
8 . . . . . . . .
```

- `.` : 空きマス
- `B` : 黒石
- `W` : 白石

## ファイル構成

- `main.c` : メイン関数、ゲームループ
- `reversi.c/h` : ゲームロジック（ボード管理、有効手判定、石を置く処理）
- `network.c/h` : ネットワーク通信機能（TCP/IP）
- `Makefile` : ビルド設定
- `CLAUDE.md` : プロジェクト仕様書

## 技術仕様

### 通信プロトコル

- 64個のint64_t型（8バイト）の配列でボード状態を表現（合計512バイト）
- リトルエンディアン形式
- 各要素の値：
  - `0` : 空きマス
  - `1` : 黒石
  - `2` : 白石
- 配列のインデックスは左上から右へ、さらに下の行へと順番に配置

### データ構造

```c
// セルの状態
typedef enum {
    EMPTY = 0,
    BLACK = 1,
    WHITE = 2
} Cell;

// プレイヤー
typedef enum {
    PLAYER_BLACK = 1,
    PLAYER_WHITE = 2
} Player;

// ボード構造体
typedef struct {
    int64_t cells[8][8];
} Board;

// ゲーム状態
typedef struct {
    Board board;
    Player current_player;
    int black_count;
    int white_count;
} Game;
```

## 開発環境

- GCC（C11準拠）
- POSIX準拠のTCP/IPソケットAPI
- macOS / Linux / Unix系OS

## ライセンス

本プロジェクトはオープンソースです。

## 注意事項

- ネットワーク対戦のため、両方のプレイヤーがネットワーク経由で接続できる必要があります
- ファイアウォール設定で指定ポートが開放されている必要があります
- 同一マシン上でテストする場合は `127.0.0.1` (localhost) を使用できます
